<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BMI Calculator</title>
    <script>
        function calculateBMI() {
            // Get input values
            const weight = parseFloat(document.getElementById('weight').value);
            const heightInFeet = parseFloat(document.getElementById('height').value);

            // Convert height from feet to meters
            const heightInMeters = heightInFeet / 3.28084;

            // Calculate BMI
            const bmi = weight / (heightInMeters * heightInMeters);
            document.getElementById('result').innerText = `Your BMI is: ${bmi.toFixed(2)}`;

            let category = '';
            let who_bmi_label = 4; // Default to "not available"

            // Determine BMI category based on WHO standards and assign corresponding labels
            if (bmi < 18.5) {
                category = 'Underweight';
                who_bmi_label = 4; // Not available
            } else if (bmi >= 18.5 && bmi < 24.9) {
                category = 'Normal';
                who_bmi_label = 3;
            } else if (bmi >= 25 && bmi < 29.9) {
                category = 'Overweight';
                who_bmi_label = 5;
            } else if (bmi >= 30 && bmi < 34.9) {
                category = 'Class 1 Obesity';
                who_bmi_label = 0;
            } else if (bmi >= 35 && bmi < 39.9) {
                category = 'Class 2 Obesity';
                who_bmi_label = 1;
            } else {
                category = 'Class 3 Obesity';
                who_bmi_label = 2;
            }

            // Display the BMI category
            document.getElementById('who_bmi').innerText = `WHO BMI: ${category}`;

            // Set hidden form fields with the calculated BMI and WHO BMI label
            document.getElementById('bmiInput').value = bmi.toFixed(2);
            document.getElementById('whoBmiInput').value = who_bmi_label;

            // Show the "Next" button after BMI is calculated
            document.getElementById('nextButton').style.display = 'block';
        }
    </script>
</head>
<body>
    <h1>BMI Calculator</h1>
    <form id="bmiForm" action="/submit_bmi" method="POST" onsubmit="event.preventDefault(); calculateBMI();">
        <label for="weight">Weight (kg):</label>
        <input type="number" id="weight" required> <br><br>

        <label for="height">Height (feet):</label>
        <input type="number" id="height" step="any" required> <br><br>

        <input type="submit" value="Calculate BMI">
    </form>

    <p id="result"></p>
    <p id="who_bmi"></p>

    <!-- Next button, hidden initially, shown after BMI calculation -->
    <form action="/submit_bmi" method="POST">
        <input type="hidden" id="bmiInput" name="bmi">
        <input type="hidden" id="whoBmiInput" name="who_bmi">
        <input type="submit" value="Next" id="nextButton" style="display: none;">
    </form>
</body>
</html>
